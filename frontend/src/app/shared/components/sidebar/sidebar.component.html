<!-- src/app/shared/components/sidebar/sidebar.component.html -->
<div class="flex flex-col h-screen bg-white shadow-lg sidebar-root">
  <!-- Logo -->
  <div class="flex items-center justify-center h-20 bg-white">
    <img
      src="https://sanmarino.com.co/wp-content/uploads/2018/06/Logo-redes-sociales-sanmarino-03.png"
      alt="Sanmarino Logo"
      class="h-12"
    />
  </div>

  <!-- Banner Bienvenida -->
  <div class="mx-3 mt-2">
    <div class="welcome-card grid grid-cols-[44px_1fr] gap-3 rounded-xl border border-yellow-300/40 bg-gradient-to-b from-yellow-100/30 to-yellow-200/30 p-3 relative overflow-hidden">
      <!-- brillo diagonal sutil -->
      <span class="pointer-events-none absolute -top-10 -right-12 w-56 h-56 rounded-full bg-white/30 blur-3xl"></span>

      <div class="avatar grid place-items-center w-11 h-11 rounded-full border border-yellow-300/60 bg-yellow-50 shadow-sm text-gray-800 font-bold">
        {{ (userBanner$ | async)?.initials }}
      </div>

      <div class="info flex flex-col">
        <div class="leading-tight">
          <span class="text-xs text-gray-500 mr-1">Bienvenido,</span>
          <strong class="text-sm text-gray-800">{{ (userBanner$ | async)?.fullName }}</strong>
        </div>

        <div class="mt-1">
          <span class="inline-block text-[11px] px-2 py-[2px] rounded-full border border-yellow-300 bg-yellow-50 text-amber-900">
            {{ (userBanner$ | async)?.company }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Menú -->
  <div class="flex-1 overflow-y-auto">
    <nav class="mt-4">
      <ul class="space-y-1">
        <li *ngFor="let item of menuItems">
          <!-- Nivel 1: ítem con submenú -->
          <ng-container *ngIf="item.children; else singleLink1">
            <button
              (click)="toggle(item)"
              class="group flex items-center w-full px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors"
              [ngClass]="{ 'bg-gray-100': item.expanded }"
            >
              <fa-icon [icon]="item.icon" class="mr-3 text-lg text-gray-600"></fa-icon>
              <span class="flex-1 text-sm font-medium">{{ item.label }}</span>
              <fa-icon
                [icon]="faChevronDown"
                class="ml-auto text-sm transition-transform duration-200"
                [ngClass]="{ 'rotate-180': item.expanded }"
              ></fa-icon>
            </button>

            <!-- Submenú Nivel 1 -->
            <ul *ngIf="item.expanded" class="mt-1 space-y-1 pl-6">
              <li *ngFor="let sub of item.children">
                <!-- Nivel 2: ítem con submenú -->
                <ng-container *ngIf="sub.children; else singleLink2">
                  <button
                    (click)="toggle(sub)"
                    class="group flex items-center w-full px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors"
                    [ngClass]="{ 'bg-gray-100': sub.expanded }"
                  >
                    <fa-icon [icon]="sub.icon" class="mr-3 text-base text-gray-600"></fa-icon>
                    <span class="flex-1 text-sm">{{ sub.label }}</span>
                    <fa-icon
                      [icon]="faChevronDown"
                      class="ml-auto text-xs transition-transform duration-200"
                      [ngClass]="{ 'rotate-180': sub.expanded }"
                    ></fa-icon>
                  </button>

                  <!-- Submenú Nivel 2 (hojas) -->
                  <ul *ngIf="sub.expanded" class="mt-1 space-y-1 pl-6">
                    <li *ngFor="let leaf of sub.children">
                      <a
                        [routerLink]="leaf.link"
                        routerLinkActive="text-red-600"
                        class="flex items-center px-4 py-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors"
                      >
                        <fa-icon [icon]="leaf.icon" class="mr-3 text-base"></fa-icon>
                        <span class="text-sm">{{ leaf.label }}</span>
                      </a>
                    </li>
                  </ul>
                </ng-container>

                <!-- Nivel 2: ítem sin submenú -->
                <ng-template #singleLink2>
                  <a
                    [routerLink]="sub.link"
                    routerLinkActive="text-red-600"
                    class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors"
                  >
                    <fa-icon [icon]="sub.icon" class="mr-3 text-base text-gray-600"></fa-icon>
                    <span class="text-sm">{{ sub.label }}</span>
                  </a>
                </ng-template>
              </li>
            </ul>
          </ng-container>

          <!-- Nivel 1: ítem sin submenú -->
          <ng-template #singleLink1>
            <a
              [routerLink]="item.link"
              routerLinkActive="bg-gray-100 text-red-600"
              [routerLinkActiveOptions]="{ exact: true }"
              class="group flex items-center px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors"
            >
              <fa-icon [icon]="item.icon" class="mr-3 text-lg text-gray-600"></fa-icon>
              <span class="flex-1 text-sm font-medium">{{ item.label }}</span>
            </a>
          </ng-template>
        </li>
      </ul>
    </nav>
  </div>

  <!-- Logout -->
  <div class="p-4 border-t border-gray-200">
    <button
      (click)="logout()"
      class="flex items-center w-full px-4 py-2 text-gray-700 hover:bg-gray-50 rounded-lg transition-colors"
    >
      <fa-icon [icon]="faSignOutAlt" class="mr-3 text-lg"></fa-icon>
      <span class="flex-1 text-sm">Cerrar Sesión</span>
    </button>
  </div>
</div>
