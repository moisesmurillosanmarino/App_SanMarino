<!-- src/app/features/config/master-lists/master-lists.component.html -->
<div class="mls-container flex">
  <!-- Sidebar -->
  <app-sidebar class="flex-shrink-0"></app-sidebar>

  <!-- Contenido -->
  <div class="flex-1 p-6 bg-warm-gray-100 min-h-screen">
    <!-- Encabezado -->
    <div class="mls-toolbar flex items-center justify-between mb-6">
      <div class="flex items-center gap-2">
        <fa-icon [icon]="faList" class="title-icon" aria-hidden="true"></fa-icon>
        <h2 class="title">Listas maestras</h2>
        <span class="counter-pill" *ngIf="lists?.length !== undefined">
          {{ lists.length }} lista(s)
        </span>
      </div>

      <button
        (click)="newList()"
        class="btn-primary"
        type="button"
      >
        <fa-icon [icon]="faPlus" class="mr-2" aria-hidden="true"></fa-icon>
        Nueva lista
      </button>
    </div>

    <!-- Tabla principal -->
    <div class="mls-card">
      <div class="table-scroll">
        <table class="mls-table" role="grid" aria-label="Tabla de listas maestras">
          <thead>
            <tr>
              <th scope="col">Key</th>
              <th scope="col">Nombre</th>
              <th scope="col"># Opciones</th>
              <th scope="col" class="text-center">Ver</th>
              <th scope="col" class="text-right">Acciones</th>
            </tr>
          </thead>

          <tbody>
            <!-- Estado vac√≠o -->
            <tr *ngIf="!lists?.length">
              <td colspan="5" class="empty-state">
                <div class="empty-illustration">üóÇÔ∏è</div>
                <p>No hay listas todav√≠a.</p>
                <button class="btn-subtle" type="button" (click)="newList()">
                  <fa-icon [icon]="faPlus" class="mr-2"></fa-icon>
                  Crear la primera
                </button>
              </td>
            </tr>

            <!-- Filas -->
            <ng-container *ngFor="let list of lists; trackBy: trackByIndex">
              <tr class="mls-row">
                <td>
                  <span class="key-badge" title="Identificador interno">{{ list.key }}</span>
                </td>
                <td class="truncate-cell" [title]="list.name">{{ list.name }}</td>

                <td>
                  <span class="count-pill">
                    {{ list.options.length }} opci√≥n(es)
                  </span>
                </td>

                <td class="text-center">
                  <button
                    type="button"
                    class="icon-btn"
                    (click)="toggleOptions(list)"
                    [attr.aria-expanded]="expandedIds.has(list.id) ? 'true' : 'false'"
                    [attr.aria-label]="'Ver opciones de ' + list.name"
                    title="Ver opciones"
                  >
                    <fa-icon [icon]="faEye" aria-hidden="true"></fa-icon>
                  </button>
                </td>

                <td class="text-right">
                  <div class="actions">
                    <button
                      type="button"
                      class="icon-btn"
                      (click)="edit(list)"
                      [attr.aria-label]="'Editar ' + list.name"
                      title="Editar"
                    >
                      <fa-icon [icon]="faPen" aria-hidden="true"></fa-icon>
                    </button>
                    <button
                      type="button"
                      class="icon-btn danger"
                      (click)="delete(list)"
                      [attr.aria-label]="'Eliminar ' + list.name"
                      title="Eliminar"
                    >
                      <fa-icon [icon]="faTrash" aria-hidden="true"></fa-icon>
                    </button>
                  </div>
                </td>
              </tr>

              <!-- Opciones expandibles -->
              <tr *ngIf="expandedIds.has(list.id)">
                <td colspan="5" class="options-cell">
                  <div class="options-grid">
                    <span
                      class="tag"
                      *ngFor="let opt of list.options; trackBy: trackByIndex"
                      [title]="opt"
                    >
                      {{ opt }}
                    </span>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>

      <!-- Overlay de carga -->
      <div class="loading-overlay" *ngIf="loading" aria-live="polite">
        <div class="spinner"></div>
        <span>Cargando‚Ä¶</span>
      </div>
    </div>
  </div>
</div>
