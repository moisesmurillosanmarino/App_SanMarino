<div class="password-recovery-shell min-h-screen flex items-center justify-center">
  <div class="recovery-card w-full max-w-md rounded-lg p-8" role="region" aria-label="Formulario de recuperación de contraseña">

    <!-- Logo -->
    <div class="flex justify-center mb-6">
      <div class="logo-wrap" role="img" aria-label="Logo Sanmarino Tecnología e Innovación">
        <img
          src="assets/brand/icono-logo.png"
          alt="Sanmarino Tecnología e Innovación"
          class="logo-img"
          loading="eager"
          decoding="async"
        />
      </div>
    </div>

    <!-- Estado de éxito -->
    <div *ngIf="success" class="success-state">
      <div class="success-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 12l2 2 4-4"/>
          <circle cx="12" cy="12" r="10"/>
        </svg>
      </div>
      <h2 class="success-title">¡Email Enviado!</h2>
      <p class="success-message">
        Se ha enviado una nueva contraseña a tu correo electrónico. 
        Revisa tu bandeja de entrada y tu carpeta de spam.
      </p>
      <div class="success-actions">
        <button type="button" class="btn btn-primary" (click)="goToLogin()">
          Ir al Login
        </button>
        <button type="button" class="btn btn-secondary" (click)="tryAgain()">
          Intentar con otro email
        </button>
      </div>
    </div>

    <!-- Formulario de recuperación -->
    <div *ngIf="!success">
      <div class="recovery-header">
        <h1 class="recovery-title">Recuperar Contraseña</h1>
        <p class="recovery-subtitle">
          Ingresa tu correo electrónico y te enviaremos una nueva contraseña
        </p>
      </div>

      <form [formGroup]="recoveryForm" (ngSubmit)="onSubmit()" class="space-y-4" novalidate>
        <!-- Error global -->
        <div *ngIf="errorMsg" class="alert-error" role="alert">
          {{ errorMsg }}
        </div>

        <!-- Email -->
        <div class="field">
          <label for="email" class="label">Correo Electrónico</label>
          <input
            id="email"
            type="email"
            formControlName="email"
            placeholder="tu@ejemplo.com"
            class="brand-input"
            autocomplete="email"
            inputmode="email"
            [attr.aria-invalid]="recoveryForm.get('email')?.invalid && recoveryForm.get('email')?.touched"
            required
          />
          <div *ngIf="recoveryForm.get('email')?.touched && recoveryForm.get('email')?.invalid" class="hint-error" role="status" aria-live="polite">
            <div *ngIf="recoveryForm.get('email')?.errors?.['required']">El correo electrónico es obligatorio.</div>
            <div *ngIf="recoveryForm.get('email')?.errors?.['email']">El formato del correo electrónico no es válido.</div>
          </div>
        </div>

        <!-- Botón -->
        <button
          type="submit"
          class="brand-btn w-full"
          [disabled]="recoveryForm.invalid || loading"
          aria-label="Enviar nueva contraseña"
        >
          {{ loading ? 'Enviando...' : 'Enviar Nueva Contraseña' }}
        </button>

        <!-- Enlace de regreso -->
        <div class="back-to-login">
          <button type="button" class="link-button" (click)="goToLogin()">
            ← Volver al Login
          </button>
        </div>
      </form>
    </div>

    <!-- Logo de marca -->
    <div class="brand-footer">
      <img
        src="assets/brand/italcol-blanco.png"
        class="logo-img-accent"
        loading="eager"
        decoding="async"
        alt="Italcol"
      />
    </div>
  </div>
</div>

<footer class="site-footer" role="contentinfo">
  <div class="footer-inner">
    <span>© {{ today | date:'yyyy' }} Sanmarino Genética Avícola</span>
    <span class="dot">•</span>
    <span>Todos los derechos reservados</span>
  </div>
</footer>



